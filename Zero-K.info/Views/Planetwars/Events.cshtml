@using ZkData
@using ZeroKWeb
@model ZeroKWeb.Controllers.EventsResult
@if (Model.Partial) {
  Layout = null;
}
@if (!Model.Partial) {
   <h3>PlanetWars events</h3>
}
<small>
@using (Ajax.BeginForm("Events", new { title = Model.Title, accountID = Model.AccountID, clanID = Model.ClanID, planetID = Model.PlanetID, springBattleID = Model.SpringBattleID, pageSize = Model.PageSize, partial = Model.Partial }, new AjaxOptions() { InsertionMode = InsertionMode.Replace, UpdateTargetId = "events", LoadingElementId = "ajaxScrollProgress" })) {
  <div id='events'>
    @Html.Hidden("page", Model.Page, new { id = "ev_page" })
    <table cellpadding='0' cellspacing='0'>
      <th>
        Time
      </th>
      <th>
        Turn
      </th>
      <th>
        Event
      </th>
      @foreach (var e in Model.Events) {
        <tr>
          <td>@e.Time.ToAgoString()
          </td>
          <td>@e.Turn
          </td>
          <td>@Html.Raw(e.Text)
          </td>
        </tr>
      }
      <tr>
        <td>
          @if (Model.Page > 0) {
            <a href="#" onclick="$('#ev_page').val($('#ev_page').val()-1); $('#ev_submit').click()">
              newer</a>
          }
        </td>
        <td colspan='2' align="right">
            @Html.TextBox("filter", Model.Filter)<input type="submit" value="filter" id="ev_submit" />

          @if (Model.Page < Model.PageCount - 1) {
            <a href="#" onclick="$('#ev_page').val($('#ev_page').val()+ 1); $('#ev_submit').click()">
              older</a>
          }
        </td>
      </tr>
    </table>
  </div>
}
</small>
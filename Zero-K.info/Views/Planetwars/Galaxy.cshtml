@using ZeroKWeb
@model ZkData.Galaxy
@{
  ViewBag.Minimal = true;
  var g = Model;

  int maxDropships = g.Planets.SelectMany(x => x.AccountPlanets).Max(x => (int?)x.DropshipCount) ?? 1; // fake max as 1 to prevent division by zero
  
}
<div style="text-align: left; border: 0;">
  <img src="@Url.Action("GalaxyImage", new { galaxyID = Model.GalaxyID })" style="position:static; text-align:left; z-index:-50; top:0px; left:0px;" width="@Model.Width" height="@Model.Height"/>
  @foreach (var p in Model.Planets) {
    var pr = p.PlanetRectangle(Model);
    
    <table cellpadding="0" cellspacing="0" style="left: @(pr.Left-40)px; top: @(pr.Top-50)px; width:@(pr.Width+80)px; height:50px;" class="pwlabel" width="@(pr.Width+80)" height="50">
      <tr>
        <td valign="bottom" align="center">
          <span title="$map$@p.MapResourceID">@p.Name<br />
          @if (r.Next(3) == 0) {
            <span style="font-size: 8px">@Global.Account.Name</span>
          }
          </span>
        </td>
      </tr>
    </table>
    
    <span style="position: absolute; left: @(pr.Left - 100)px; top: @(pr.Top)px; width: 100px; height: @(pr.Height)px; text-align:right;">
      <table cellpadding="0" cellspacing="0" style="font-size:2px;">
      <tr>
       <td rowspan="2" width='100%'></td>
      <td>
      <img src='/img/clans/1.png' width='20' />
      </td>
      </tr>
      @if (r.Next(3) == 0) {
      <tr>
      <td><img src='/img/flags/cz.png' width='10' /></td>
      </tr>
      }
      </table>
    </span>
    
    <span style="position: absolute; left: @(pr.Right)px; top: @(pr.Top)px; width: 100px; height: @(pr.Height)px; display:inline-block;">
    @if (r.Next(3)==0) {
      <img src='/img/fleets/war.png' width='15' /><span style="font-size:10px">4</span>
      }
    </span>
  }
</div>

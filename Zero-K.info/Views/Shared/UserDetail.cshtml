@model ZkData.Account
@using ZkData;
@{
  Page.Title = Model.Name;
}
<h2>@Html.PrintAccount(Model)</h2>
<table>
  <tr>
    <td valign="top">
      <table>
        <tr>
          <td>
            Level:
          </td>
          <td>@Model.Level
          </td>
        </tr>
        <tr>
          <td>
            XP:
          </td>
          <td>@Model.XP
          </td>
        </tr>
        <tr>
          <td>
            XP for next level:
          </td>
          <td>@Account.GetXpForLevel(Model.Level + 1)
          </td>
        </tr>
        <tr>
          <td>
            Aliases:
          </td>
          <td>@Model.Aliases
          </td>
        </tr>
        <tr>
          <td>
            Elo:
          </td>
          <td>@Model.Elo
          </td>
        </tr>
        @if (Model.IsAdmin) {
          <tr>
            <td>
              Administrator:
            </td>
            <td>@(Model.IsLobbyAdministrator ? "Lobby" : "Zero-K")
            </td>
          </tr>
        }
        <tr>
          <td>
            First login:
          </td>
          <td>@Model.FirstLogin.ToAgoString()
          </td>
        </tr>
        <tr>
          <td>
            Last login:
          </td>
          <td>@Model.LastLogin.ToAgoString()
          </td>
        </tr>
        <tr>
          <td>
            Games played:
          </td>
          <td>@Model.SpringBattlePlayers.Count()
          </td>
        </tr>
        <tr>
          <td>
            Missions played:
          </td>
          <td>@Model.MissionRunCount
          </td>
        </tr>
        <tr>
          <td>
            Post count:
          </td>
          <td>@Model.ForumPosts.Count()
          </td>
        </tr>
        @foreach (var award in Model.AccountBattleAwards.GroupBy(x => x.AwardKey).OrderByDescending(x => x.Count())) {
          <tr>
            <td>
              <img src="http://zero-k.googlecode.com/svn/trunk/mods/zk/LuaRules/Images/awards/trophy_@(award.Key).png" height="30" alt="@award.Key"/>
            </td>
            <td>@award.Count()
            </td>
          </tr>    
        }
      </table>
      <a href='spring://chat/user/@Model.Name'>Send private message to @Model.Name</a>
    </td>
    <td width="40%" valign="top">
      <h3>
        Posted threads</h3>
      @foreach (var t in Model.ForumPosts.Select(x => x.ForumThread).Distinct().OrderByDescending(x => x.ForumThreadID).Take(10)) { 
        <small>* <a href='@Url.Action("Thread", "Forum", new { id = t.ForumThreadID })' title='$thread$@t.ForumThreadID'>@t.Title</a></small><br />
      }
      <h3>
        Last battles</h3>
      @foreach (var b in Model.SpringBattlePlayers.OrderByDescending(x => x.SpringBattleID).Select(x => x.SpringBattle).Take(10)) {
        <small>@Html.PrintBattle(b)</small><br />
      }
      </span>
    </td>
  </tr>
  <tr>
    <td colspan='2'>
        @if (ZeroKWeb.Global.IsAdmin) {
      <h3>Admin extras</h3>
      <a href="@Url.Content("~/UnlocksAdmin.aspx")">Unlocks admin</a><br />
      <a href="@Url.Content("~/ResourceList.aspx")">Resource list</a><br />
    }

      <h3>
        Unlocked:</h3>
      under construction..
      <h3>
        Available unlocks:</h3>
      under construction..
    </td>
  </tr>
</table>
